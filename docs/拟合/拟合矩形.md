# 拟合矩形

## 算子

fit_rectangle2_contour_xld 

## 结构

```fit_rectangle2_contour_xld(Contours : : Algorithm, MaxNumPoints, MaxClosureDist, ClippingEndPoints, Iterations, ClippingFactor : Row, Column, Phi, Length1, Length2, PointOrder)```

## 作用

根据给到的不规则的轮廓 Contours，通过某些算法 Algorithm（通常用'tukey'），计算出近似于该轮廓的矩形；

返回计算出的矩形的中心点坐标 Row, Column，旋转角度Phi，主轴的长的一半Length1，另一轴的长的一半Length2。

> 主轴：Phi指示的方向为主轴。

## 示例

```

dev_get_window (WindowHandle)
read_image (Image1, 'printer_chip/printer_chip_01')

* 缩小定义域：
* draw_rectangle2 (WindowHandle, Row, Column, Phi, Length1, Length2)
* gen_rectangle2 (Rectangle1, Row, Column, Phi, Length1, Length2)
gen_rectangle2 (Rectangle1, 617.234, 469.039, -1.61717, 153.86, 181.768)

reduce_domain (Image1, Rectangle1, ImageReduced1)

* 亚像素提取：
edges_sub_pix (ImageReduced1, Edges, 'canny', 1, 20, 40)

* 选择最外面的轮廓拟合矩形（可以通过‘特征检测’查看轮廓特征值）
select_shape_xld (Edges, SelectedXLD, 'area', 'and', 72382.1, 99999)

* 拟合矩形
fit_rectangle2_contour_xld (SelectedXLD, 'tukey', -1, 0, 0, 3, 2, Row1, Column1, Phi1, Length11, Length21, PointOrder)

* 显示拟合出的矩形：
dev_set_color('yellow')
gen_rectangle2_contour_xld (Rectangle2, Row1, Column1, Phi1, Length11, Length21)
```

## 备注

若提示 ``` not enough valid points for fetting the model```， 错误代码 3274，表示用于拟合矩形的轮廓的点数量太少，查看提供的轮廓是不是不对(新手易错用自己绘制的矩形轮廓，只有5个轮廓点)。一般用提取的亚像素边缘轮廓来拟合。



## 示例图片

![示例图片](http://qn.halcon.lizhenguo.cn/image/%E6%8B%9F%E5%90%88%E7%9F%A9%E5%BD%A2.png)